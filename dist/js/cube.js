// Thanks to Jordan Leigh for publishing the code (https://jordizle.com/contact/)
var userPrefix,events=new Events;function Events(){this.events={}}events.add=function(t){t.events={}},events.implement=function(t){t.prototype=Object.create(Events.prototype)},Events.prototype.on=function(t,i){var e=this.events[t];return void 0==e?(this.events[t]=[i],this.emit("event:on",i)):-1==e.indexOf(i)&&(e.push(i),this.emit("event:on",i)),this},Events.prototype.once=function(t,i){var e=this.events[t];return i.once=!0,e?-1==e.indexOf(i)&&(e.push(i),this.emit("event:once",i)):(this.events[t]=[i],this.emit("event:once",i)),this},Events.prototype.emit=function(t,i){var e=this.events[t];if(e)for(var s=e.length;s--;)e[s]&&(e[s].call(this,i),e[s].once&&delete e[s]);return this},Events.prototype.unbind=function(t,i){if(t){var e=this.events[t];if(e){if(i){var s=e.indexOf(i);-1!=s&&delete e[s]}else delete this.events[t]}}else delete this.events,this.events={};return this};var prefix=function(){var t=window.getComputedStyle(document.documentElement,""),i=(Array.prototype.slice.call(t).join("").match(/-(moz|webkit|ms)-/)||""===t.OLink&&["","o"])[1];userPrefix={dom:"WebKit|Moz|MS|O".match(RegExp("("+i+")","i"))[1],lowercase:i,css:"-"+i+"-",js:i[0].toUpperCase()+i.substr(1)}}();function bindEvent(t,i,e){t.addEventListener?t.addEventListener(i,e,!1):t.attachEvent("on"+i,e)}function Viewport(t){events.add(this);var i=this;this.element=t.element,this.fps=t.fps,this.sensivity=t.sensivity,this.sensivityFade=t.sensivityFade,this.touchSensivity=t.touchSensivity,this.speed=t.speed,this.lastX=0,this.lastY=0,this.mouseX=0,this.mouseY=0,this.distanceX=0,this.distanceY=0,this.positionX=1122,this.positionY=136,this.torqueX=0,this.torqueY=0,this.down=!1,this.upsideDown=!1,this.previousPositionX=0,this.previousPositionY=0,this.currentSide=0,this.calculatedSide=0,bindEvent(document,"mousedown",function(){i.down=!0}),bindEvent(document,"mouseup",function(){i.down=!1}),bindEvent(document,"keyup",function(){i.down=!1}),bindEvent(document,"mousemove",function(t){i.mouseX=t.pageX,i.mouseY=t.pageY}),bindEvent(document,"touchstart",function(t){i.down=!0,t.touches&&(t=t.touches[0]),i.mouseX=t.pageX/i.touchSensivity,i.mouseY=t.pageY/i.touchSensivity,i.lastX=i.mouseX,i.lastY=i.mouseY}),bindEvent(document,"touchmove",function(t){t.preventDefault&&t.preventDefault(),1==t.touches.length&&(t.touches&&(t=t.touches[0]),i.mouseX=t.pageX/i.touchSensivity,i.mouseY=t.pageY/i.touchSensivity)}),bindEvent(document,"touchend",function(t){i.down=!1}),setInterval(this.animate.bind(this),this.fps)}events.implement(Viewport),Viewport.prototype.animate=function(){this.distanceX=this.mouseX-this.lastX,this.distanceY=this.mouseY-this.lastY,this.lastX=this.mouseX,this.lastY=this.mouseY,this.down&&(this.torqueX=this.torqueX*this.sensivityFade+(this.distanceX*this.speed-this.torqueX)*this.sensivity,this.torqueY=this.torqueY*this.sensivityFade+(this.distanceY*this.speed-this.torqueY)*this.sensivity),(Math.abs(this.torqueX)>1||Math.abs(this.torqueY)>1)&&(this.down||(this.torqueX*=this.sensivityFade,this.torqueY*=this.sensivityFade),this.positionY-=this.torqueY,this.positionY>360?this.positionY-=360:this.positionY<0&&(this.positionY+=360),this.positionY>90&&this.positionY<270?(this.positionX-=this.torqueX,this.upsideDown||(this.upsideDown=!0,this.emit("upsideDown",{upsideDown:this.upsideDown}))):(this.positionX+=this.torqueX,this.upsideDown&&(this.upsideDown=!1,this.emit("upsideDown",{upsideDown:this.upsideDown}))),this.positionX>360?this.positionX-=360:this.positionX<0&&(this.positionX+=360),this.positionY>=46&&this.positionY<=130||this.positionY>=220&&this.positionY<=308?(this.positionY>=46&&this.positionY<=130&&(this.calculatedSide=6),this.positionY>=220&&this.positionY<=308&&(this.calculatedSide=1)):this.upsideDown?this.positionX>=42&&this.positionX<=130?this.calculatedSide=3:this.positionX>=131&&this.positionX<=223?this.calculatedSide=2:this.positionX>=224&&this.positionX<=314?this.calculatedSide=5:this.calculatedSide=4:this.positionX>=42&&this.positionX<=130?this.calculatedSide=5:this.positionX>=131&&this.positionX<=223?this.calculatedSide=4:this.positionX>=224&&this.positionX<=314?this.calculatedSide=3:this.calculatedSide=2,this.calculatedSide!==this.currentSide&&(this.currentSide=this.calculatedSide,this.emit("sideChange"))),this.element.style[userPrefix.js+"Transform"]="rotateX("+this.positionY+"deg) rotateY("+this.positionX+"deg)",(this.positionY!=this.previousPositionY||this.positionX!=this.previousPositionX)&&(this.previousPositionY=this.positionY,this.previousPositionX=this.positionX,this.emit("rotate"))};var viewport=new Viewport({element:document.getElementsByClassName("cube")[0],fps:20,sensivity:.1,sensivityFade:.93,speed:2,touchSensivity:1.5});function Cube(t){var i=this;this.element=t.element,this.sides=this.element.getElementsByClassName("side"),this.viewport=t.viewport,this.viewport.on("rotate",function(){i.rotateSides()}),this.viewport.on("upsideDown",function(t){i.upsideDown(t)}),this.viewport.on("sideChange",function(){i.sideChange()})}Cube.prototype.rotateSides=function(){var t=this.viewport;t.positionY>90&&t.positionY<270?(this.sides[0].getElementsByClassName("cube-image")[0].style[userPrefix.js+"Transform"]="rotate("+(t.positionX+t.torqueX)+"deg)",this.sides[5].getElementsByClassName("cube-image")[0].style[userPrefix.js+"Transform"]="rotate("+-(t.positionX+180+t.torqueX)+"deg)"):(this.sides[0].getElementsByClassName("cube-image")[0].style[userPrefix.js+"Transform"]="rotate("+(t.positionX-t.torqueX)+"deg)",this.sides[5].getElementsByClassName("cube-image")[0].style[userPrefix.js+"Transform"]="rotate("+-(t.positionX+180-t.torqueX)+"deg)")},Cube.prototype.upsideDown=function(t){for(var i=!0==t.upsideDown?"180deg":"0deg",e=5;e>0&&--e;)this.sides[e].getElementsByClassName("cube-image")[0].style[userPrefix.js+"Transform"]="rotate("+i+")"},Cube.prototype.sideChange=function(){for(var t=0;t<this.sides.length;++t)this.sides[t].getElementsByClassName("cube-image")[0].className="cube-image";this.sides[this.viewport.currentSide-1].getElementsByClassName("cube-image")[0].className="cube-image active"},new Cube({viewport:viewport,element:document.getElementsByClassName("cube")[0]});